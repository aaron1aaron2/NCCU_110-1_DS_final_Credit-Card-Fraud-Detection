# 2021.12.21 - DS ç¬¬ä¸€æ¬¡é–‹æœƒ - æ–¹å‘èˆ‡åˆ†å·¥

# è³‡è¨Šçµ±æ•´

---

## æ¬„ä½èªªæ˜

- **Time**: èˆ‡ç¬¬ä¸€ç­†è³‡æ–™é–“éš”çš„ç§’æ•¸
- **Amount**: äº¤æ˜“é‡‘é¡
- **Class**: æ˜¯å¦ç‚ºè©æ¬ºäº¤æ˜“ï¼Œ1ä»£è¡¨è©æ¬ºäº¤æ˜“
- **V1 ~ V28**: PCA ç‰¹å¾µ

## ä¸»è¦å•é¡Œèˆ‡è§£æ³•

### æ¨™æº–åŒ–

> å°æ•¸å€¼å‹è³‡æ–™æ¨™æº–åŒ–ï¼Œæ˜¯åšæ©Ÿå™¨å­¸ç¿’å¿…è¦çš„å‰ç½®å‹•ä½œï¼Œç¢ºä¿æ¨¡å‹ä¸æœƒå› ç‚ºå„æ¬„ä½çš„æ•¸å€¼ç¯„åœèˆ‡å–®ä½å¤§å°ä¸åŒï¼Œå°è‡´æ¨¡å‹æœƒåå‘æŸäº›æ•¸å€¼è¼ƒå¤§çš„æ¬„ä½ã€‚
> 
- PCA çš„æ¬„ä½æœ¬èº«å·²ç¶“åšéæ¨™æº–åŒ–ã€‚
- Time ã€Amount è¦åš

### æ¥µç«¯å€¼

> å¦‚æœè³‡æ–™ä¸­æœ‰æ¥µç«¯å€¼ï¼Œæ¨¡å‹æœƒä¸å¤ªå¥½å»æ‰¾åˆ°è³‡æ–™çš„ patternï¼Œå¯èƒ½è¢«æŸäº›æ¥µç«¯å€¼æ‹‰èµ°ã€‚
> 
- **åˆ¥äººä½œæ³• â†’ ç§»é™¤èˆ‡é æ¸¬ç›®æ¨™ç›¸é—œæ€§é«˜çš„æ¥µç«¯å€¼**
    - Our main aim in this section is to remove "extreme outliers" from features that have a high correlation with our classes. This will have a positive impact on the accuracy of our models.
    (é€™ç¯‡çš„ä½œæ³•: **[Credit Fraud || Dealing with Imbalanced Datasets](https://www.kaggle.com/janiobachmann/credit-fraud-dealing-with-imbalanced-datasets)** )
    - ä½¿ç”¨å››åˆ†ä½æ•¸ & boxplot å»è§€å¯Ÿæ¥µç«¯å€¼èˆ‡è¨­å®šé–€æª»
- â­ **Outlier Removal Tradeoff  ç§»é™¤æ¥µç«¯å€¼çš„é–€æª»è¨­å®šå°æ¨¡å‹åˆ†é¡çš„å½±éŸ¿èˆ‡å–æ¨ã€‚**
    1. å°æ–¼æ¥µç«¯å€¼å‰ç½®æ¢ä»¶:  ç•¶è³‡æ–™è¶…é IQR æ™‚ï¼Œæ‰ç®—æ¥µç«¯å€¼ã€‚éœ€è¦è¨­å®šä¸€å€‹é©åˆé–€æª»ã€‚å¯ä»¥ç¹ªè£½ä¸€å€‹å–ç·šå»æ‰¾é–€æª»ã€‚ x ç‚ºä¸åŒ å€æ•¸ IQRç‚ºæ¢ä»¶ç§»é™¤çš„æ¥µç«¯å€¼ï¼Œy ç‚ºæ¨¡å‹æ•ˆæœçš„è©•ä¼°å€¼ã€‚
        - è£œå……: å››åˆ†ä½é–“è·ï¼ˆinterquartile rangeï¼Œç°¡ç¨±IQRï¼‰= ${\displaystyle (Q3-Q1)}{\displaystyle (Q3-Q1)}$ ï¼ˆå³Î”Qï¼‰ã€‚ä¸€èˆ¬ä¾†èªª 1.5Ã—IQR ~ 3Ã—IQRç¯„åœçš„æ•¸å€¼ï¼Œç¨±ä½œé©åº¦é›¢ç¾¤å€¼ï¼ˆmild outlierï¼‰ã€‚
        æ•¸å€¼ä½æ–¼ç¯„åœå¤–3Ã—IQRä»¥ä¸Šçš„æ•¸å€¼ï¼Œç¨±ä½œæ¥µç«¯é›¢ç¾¤å€¼ï¼ˆextreme outlierï¼‰ã€‚
        
        â“è¦å…¨éƒ¨ä¸€èµ·åš?é‚„æ˜¯æ¯å€‹æ¬„ä½å„è‡ªåš?
        
    2. ç›¸é—œæ€§é«˜çš„æ¥µç«¯å€¼å°æ¨¡å‹çµæœçš„å½±éŸ¿: åªè¦é”åˆ°æ¢ä»¶å°±æ’é™¤å’Œåªæ’é™¤èˆ‡ç›®æ¨™ç›¸é—œæ€§é«˜çš„æ¬„ä½
![](img/boxplot1.png)
![](img/boxplot2.png)

### è³‡æ–™ä¸å¹³è¡¡

> åœ¨è³‡æ–™ä¸å¹³è¡¡çš„æƒ…æ³ä¸‹ï¼Œæ¨¡å‹å¯èƒ½æœƒå‚¾å‘é æ¸¬æ¯”è¼ƒå¤šçš„é‚£ä¸€é¡(0)ï¼Œç•¢ç«Ÿå°æ¨¡å‹ä¾†èªªä¸ç”¨å‹•è…¦å…¨éƒ¨ç”¨çŒœ0å°±å¯ä»¥å¾—åˆ°å¾ˆé«˜çš„æº–ç¢ºç‡ã€‚æ‰€ä»¥åœ¨é€™æƒ…æ³ä¸‹ï¼Œæº–ç¢ºç‡æ²’ç”šéº¼åƒè€ƒæ€§ã€‚æ‰€ä»¥æˆ‘å€‘éœ€è¦é¼“å‹µæ¨¡å‹å¤šå»çŒœ 1ã€‚
> 
- â­ **under sampling**
    - å¯ä»¥ä½¿ç”¨under samplingçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯èªªåœ¨è¨“ç·´æ¨¡å‹æ™‚åªæŠ½å–éƒ¨åˆ†0çš„è³‡æ–™å»å¯¦ä½œï¼Œä¸€èˆ¬ä¾†èªªå–çš„ 0 è¶Šå°‘ precision æœƒä¸‹é™ï¼Œrecallæœƒä¸Šå‡ã€‚
    â†’ *æ‰€ä»¥è¦æ‰¾åˆ°ä¸€å€‹å¹³è¡¡é»ï¼Œé›–ç„¶èƒ½æ‰¾åˆ°å¤§éƒ¨åˆ†çš„1ï¼Œä½†æ˜¯æ¨¡å‹æ¯çŒœ10å€‹åªä¸­ä¸€å€‹1ï¼Œé‚£æœªå¿…æ˜¯å€‹å¥½æ¨¡å‹ã€‚*
    - under sampling å¯ä»¥å¯¦é©—çš„é …ç›®
        - æŠ½æ¨£æ–¹å¼ â†’ ç›´æ¥éš¨æ©Ÿ or åˆ†ç¾¤éš¨æ©Ÿ
        - ä¸åŒçš„æ¯”ä¾‹ â†’ æˆ‘å€‘å¯ä»¥é€éæŠ½å–1çš„æ•¸é‡æ§åˆ¶1èˆ‡0çš„æ¯”ä¾‹ï¼Œæ¸¬è©¦ä¸åŒæ¯”ä¾‹çµ„æˆçš„è¨“ç·´é›†å°æ¨¡å‹çš„æ•ˆæœ
- **over sampling**
    - å¢åŠ  1 çš„æ¨£æœ¬ï¼Œé€™æ–¹å¼å¯ä»¥æ¸¬è©¦çœ‹çœ‹
- â­ **ä½¿ç”¨é›™å±¤ model**
    - ç¬¬ä¸€å€‹ model è² è²¬æ‰¾åˆ°æ‰€æœ‰çš„1ã€‚ä¹Ÿå°±æ˜¯èªªï¼Œä»–åªè¦æœ‰è¾¦æ³•å…ˆæŠŠä¸å¯èƒ½æ˜¯1çš„æ’é™¤ï¼Œæ‰€ä»¥ä¸»è¦æ˜¯çœ‹ recall ã€‚æ­¤ä½œæ³•æœ‰é»è®Šç›¸çš„ under sampling ï¼Œå®ƒå¯ä»¥é™ä½è³‡æ–™ä¸­ 1çš„æ¯”ä¾‹ã€‚
    - ç¬¬äºŒå€‹ model å‰‡å¯ä»¥åœ¨æ›´å¥½çš„ç’°å¢ƒä¸‹å»æ‰¾å‡ºçœŸçš„æ˜¯è©æ¬ºçš„äº¤æ˜“

### æ©Ÿç‡é æ¸¬é–€æª»

> æ¨¡å‹é æ¸¬çš„æ©Ÿç‡éœ€è¦è¶…éå¤šå°‘æ‰è¦–ç‚ºè©æ¬º?
> 
- â­ å¯ä»¥è©±é›™æ›²ç·šåœ–ï¼Œxè»¸ç‚ºæ¨¡å‹é æ¸¬çš„æ©Ÿç‡å€¼(è¨­å®šbin)ï¼Œyç‚ºæ•¸é‡ç´¯ç©ã€‚

```r
ggplot(data=spamTest) + geom_density(aes(x=pred,color=spam,linetype=spam))
```

![](img/pred_Density_plot.png)

### æ–°ç‰¹å¾µçš„å»ºç«‹

- â­ åœ¨æ™‚é–“ä¸Šæœƒä¸æœƒæœ‰ç”šéº¼è¦å¾‹?
    - å¦‚æœè©æ¬ºäº¤æ˜“åœ¨æ™‚é–“ä¸Šæœ‰å¥é›†çš„è¶¨å‹¢å°±å¯ä»¥å»ºç«‹åƒæ˜¯è©²ç­†äº¤æ˜“å‰ 5 ç§’å…§æœ‰æ²’æœ‰å…¶ä»–è©æ¬ºäº¤æ˜“çš„ç‰¹å¾µ
    - æœ‰é€±æœŸæ€§çš„ç™¼ç”Ÿä¹‹é¡çš„ï¼Œå¯èƒ½éƒ½åœ¨éŠ€è¡Œä¸‹ç­å¾Œæ¯”è¼ƒå¤šã€‚ä½†æ˜¯åªæœ‰å…©å¤©è³‡æ–™å¯èƒ½çœ‹ä¸å¤ªå‡ºä¾† ğŸ˜¢
- â­ Amount çš„é¡åˆ¥åŒ–ï¼Œæœƒä¸æœƒåœ¨æŸäº›é‡‘é¡å€é–“ï¼Œè©æ¬ºäº¤æ˜“ç™¼ç”Ÿçš„é »ç‡è¼ƒé«˜ã€‚

### é™ç¶­èˆ‡åˆ†ç¾¤

> é€éé™ç‚ºæ¼”ç®—æ³•å¯èƒ½å¯ä»¥è®“è©æ¬ºèˆ‡éè©æ¬ºè³‡æ–™åˆ†å¾—æ›´å¥½ï¼Œä½†éœ€è¦æ¸¬è©¦çœ‹çœ‹ï¼Œä¸‹åœ–ä½¿ç”¨ä¸åŒæ¼”ç®—æ³•å°‡è³‡æ–™é™åˆ° 2ç¶­ï¼Œä¸¦å‘ˆç¾è©æ¬ºèˆ‡éè©æ¬ºè³‡æ–™çš„åˆ†å¸ƒ
> 


![](img/Dimensionality_reduction.png)


### è©•ä¼°æŒ‡æ¨™é¸æ“‡

> ä¸åŒè©•ä¼°æŒ‡æ¨™èƒŒå¾Œçš„æ¶µç¾©ä¸ä¸€æ¨£ï¼Œè©•ä¼°æŒ‡æ¨™ä¸ä¸€å®šåªç”¨ä¸€å€‹ï¼Œæˆ‘å€‘å¯ä»¥è·‘å¤šå€‹å»æ¯”è¼ƒèˆ‡è§£é‡‹
> 
- ä¸»è¾¦å–®ä½æ¨è–¦ â†’ Area Under the Precision-Recall Curve (AUPRC)
- ä¹Ÿå¯ä»¥ä½¿ç”¨ â†’ f1-score, precision/recall score or confusion matrix
- è€å¸«æ•™çš„ â†’ topic3_measurement 70-83

## æ¨¡å‹

åœ¨ [é€™å€‹](https://www.kaggle.com/arbazkhan971/credit-card-eda-25-models-for-beginners) notebook æœ‰æ¯”è¼ƒå¸¸ç”¨çš„å¹¾å€‹æ¨¡å‹ï¼Œå› ç‚ºæ˜¯åœ¨ python å¯¦ä½œæ‰€ä»¥æœ‰äº›æ¨¡å‹ä¸ä¸€å®šåœ¨ R å¯ä»¥æ‰¾åˆ°ã€‚ä½†æˆ‘è¦ºå¾—é€™éƒ¨åˆ†å¤§æ¦‚æŒ‘å€‹ 3-5 å€‹æ¨¡å‹åšæ¯”è¼ƒï¼Œå¯ä»¥æŒ‘å¹¾å€‹å¸¸è¦‹çš„ random forestã€logic å›æ­¸ã€knnã€‚

![æ¨¡å‹æ•ˆæœæ¯”è¼ƒ](img/model2_rank.png)

æ¨¡å‹æ•ˆæœæ¯”è¼ƒ

## å¯¦ä½œæ¶æ§‹

1. è³‡æ–™é›†ä»‹ç´¹èˆ‡ä¸»è¦çš„æŒ‘æˆ°
2. EDA
    - ä¸åŒæ¬„ä½çš„åˆ†å¸ƒ
    - ç›¸é—œæ€§åˆ†æ â†’ è®Šæ•¸é–“ç†±åœ–ã€è®Šæ•¸å°ç›®æ¨™é¡åˆ¥çš„ç®±å‹åœ–
        
3. è©•ä¼°æŒ‡æ¨™çš„é¸æ“‡(ç‚ºä»€éº¼æˆ‘å€‘è¦ä½¿ç”¨é€™äº›æŒ‡æ¨™)
4. ä¸åŒå•é¡Œçš„å¯¦é©—èˆ‡è™•ç†
    - è³‡æ–™ä¸å¹³è¡¡
    - æ¥µç«¯å€¼
    - é æ¸¬é–€æª»
    - æ–°ç‰¹å¾µçš„å»ºç«‹
    - ä½¿ç”¨é™ç¶­æ–¹å¼åˆ†ç¾¤
5. ä¸åŒæ¨¡å‹çš„æ¸¬è©¦èˆ‡æ¯”è¼ƒ
6. çµè«–

# æœƒè­°è¨˜éŒ„

---

### åˆ†å·¥

- å ±å‘Šã€ç°¡å ±å’Œå‰ä¸‰ç« 
    - è‘‰åˆç‘„
    - é®‘è•¾é›…
    - æ—ä½‘å½¥
- å¾Œä¸‰å¼µ:
    - é™³å‰ç‘„
    - ä½•å½¥å—

# åƒè€ƒè³‡æº

---

## æ•´ç†è¨±å¤šä¸åŒæ¨¡å‹æ¸¬è©¦

[Credit Card Fraud Detection](https://www.kaggle.com/mlg-ulb/creditcardfraud/discussion/277570)

## ä¸å¹³è¡¡è³‡æ–™èˆ‡æ¥µç«¯å€¼è™•ç†(è©³ç´°èªªæ˜)

[Credit Fraud || Dealing with Imbalanced Datasets](https://www.kaggle.com/janiobachmann/credit-fraud-dealing-with-imbalanced-datasets)

[ä¿¡ç”¨å¡è©é¨™åˆ†æ-ä¸å¹³è¡¡è³‡æ–™åˆ†æèˆ‡è™•ç†kernel-å®Œæ•´ç‰ˆ](https://medium.com/%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E7%9F%A5%E8%AD%98%E6%AD%B7%E7%A8%8B/%E4%BF%A1%E7%94%A8%E5%8D%A1%E8%A9%90%E9%A8%99%E5%88%86%E6%9E%90-%E4%B8%8D%E5%B9%B3%E8%A1%A1%E8%B3%87%E6%96%99%E5%88%86%E6%9E%90%E8%88%87%E8%99%95%E7%90%86kernel%E7%BF%BB%E8%AD%AFpart1-7f1b0a645f9a)

## R çš„å¯¦ä½œç¯„ä¾‹

[Credit Card Fraud Detection with R + (sampling)](https://www.kaggle.com/atharvaingle/credit-card-fraud-detection-with-r-sampling)